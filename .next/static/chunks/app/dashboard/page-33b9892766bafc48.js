(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{26052:function(e,t,a){Promise.resolve().then(a.bind(a,53491))},53491:function(e,t,a){"use strict";a.r(t);var s=a(57437);a(2265);var n=a(95424),i=a.n(n),l=a(42333),o=a(82749),r=a(24033),c=a(16691),u=a.n(c);t.default=()=>{var e;let t=(0,o.useSession)(),a=(0,r.useRouter)(),{data:n,mutate:c,error:d,isLoading:p}=(0,l.ZP)("/api/posts?username=".concat(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.user.name),function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return fetch(...t).then(e=>e.json())});if("loading"===t.status)return(0,s.jsx)("p",{children:"Loading..."});"unauthenticated"===t.status&&(null==a||a.push("/dashboard/login"));let handleSubmit=async e=>{e.preventDefault();let a=e.target[0].value,s=e.target[1].value,n=e.target[2].value,i=e.target[3].value;try{await fetch("/api/posts",{method:"POST",body:JSON.stringify({title:a,desc:s,img:n,content:i,username:t.data.user.name})}),c(),e.target.reset()}catch(e){console.log(e)}},handleDelete=async e=>{try{await fetch("/api/posts/".concat(e),{method:"DELETE"}),c()}catch(e){console.log(e)}};if("authenticated"===t.status)return(0,s.jsxs)("div",{className:i().container,children:[(0,s.jsx)("div",{className:i().posts,children:p?"loading":null==n?void 0:n.map(e=>(0,s.jsxs)("div",{className:i().post,children:[(0,s.jsx)("div",{className:i().imgContainer,children:(0,s.jsx)(u(),{src:e.img,alt:"",width:200,height:100})}),(0,s.jsx)("h2",{className:i().postTitle,children:e.title}),(0,s.jsx)("span",{className:i().delete,onClick:()=>handleDelete(e._id),children:"X"})]},e._id))}),(0,s.jsxs)("form",{className:i().new,onSubmit:handleSubmit,children:[(0,s.jsx)("h1",{children:"Add New Post"}),(0,s.jsx)("input",{type:"text",placeholder:"Title",className:i().input}),(0,s.jsx)("input",{type:"text",placeholder:"Desc",className:i().input}),(0,s.jsx)("input",{type:"text",placeholder:"Image",className:i().input}),(0,s.jsx)("textarea",{placeholder:"Content",className:i().textArea,cols:"30",rows:"10"}),(0,s.jsx)("button",{className:i().button,children:"Send"})]})]})}},95424:function(e){e.exports={container:"page_container__WJamO",posts:"page_posts__eax_C",post:"page_post__pXkpz",imgContainer:"page_imgContainer__jS3d9",img:"page_img__us61D",delete:"page_delete__kVuRb",new:"page_new__XOsfM",input:"page_input__olAOO",textArea:"page_textArea__29HOB",button:"page_button__4CD3K"}}},function(e){e.O(0,[413,749,503,971,472,744],function(){return e(e.s=26052)}),_N_E=e.O()}]);